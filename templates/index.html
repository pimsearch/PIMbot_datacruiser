<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PIMBOT - Data Cruiser</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
  <link rel="shortcut icon" href="/static/icone.ico">
  <link rel="stylesheet" href="/static/style.css">
</head>
<body class="text-light">

  <!-- Header fixo no topo -->
  <header class="py-1 bg-dark border-bottom mb-4">
    <div class="container d-flex justify-content-between align-items-center">
      <div>
        <img src="/static/logo.png" alt="PIMBOT" style="width: 150px;" />
      </div>
      <div class="d-flex align-items-right">
        <div class="px-2 m-1">
          <a href="https://wa.me/5519995927528" target="_blank">
            <button type="submit" class="btn btn-success w-10">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-whatsapp" viewBox="0 0 16 16">
              <path d="M13.601 2.326A7.85 7.85 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.9 7.9 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.9 7.9 0 0 0 13.6 2.326zM7.994 14.521a6.6 6.6 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.56 6.56 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592m3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.73.73 0 0 0-.529.247c-.182.198-.691.677-.691 1.654s.71 1.916.81 2.049c.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232"/>
            </svg>
            </button>
          </a>
        </div>
        <div class="px-2 m-1">
          <a href="https://github.com/pimsearch/PIMbot_datacruiser" target="_blank">
            <button type="submit" class="btn btn-success w-10">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.01 8.01 0 0 0 16 8c0-4.42-3.58-8-8-8"/>
              </svg>
            </button>
          </a>
        </div>
        <div class="px-2 m-1">
          <a href="https://datacruiser.pimsearch.com" target="_blank">
            <button type="submit" class="btn btn-success w-10">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-browser-chrome" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M16 8a8 8 0 0 1-7.022 7.94l1.902-7.098a3 3 0 0 0 .05-1.492A3 3 0 0 0 10.237 6h5.511A8 8 0 0 1 16 8M0 8a8 8 0 0 0 7.927 8l1.426-5.321a3 3 0 0 1-.723.255 3 3 0 0 1-1.743-.147 3 3 0 0 1-1.043-.7L.633 4.876A8 8 0 0 0 0 8m5.004-.167L1.108 3.936A8.003 8.003 0 0 1 15.418 5H8.066a3 3 0 0 0-1.252.243 2.99 2.99 0 0 0-1.81 2.59M8 10a2 2 0 1 0 0-4 2 2 0 0 0 0 4"/>
              </svg>
            </button>
          </a>
        </div>
        <div class="px-2 m-1">
          <a href="https://www.trustpilot.com/evaluate/pimsearch.com" target="_blank">
            <button type="submit" class="btn btn-success w-10">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-star-fill" viewBox="0 0 16 16">
                <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
              </svg>
            </button>
          </a>
        </div>
      </div>
    </div>
  </header>


  <div class="container pbottom150 text-center d-flex flex-wrap justify-content-center align-items-center">
    <div class="mb-4" style="width: 500px;">
      <h2 class="my-3">Data Cruiser</h2>
      <p>
        <span>
          O <b>Data Cruiser</b> compara dados de duas planilhas, simulando um PROCV no Excel.
          Diferente do PROCV, que retorna apenas o primeiro resultado, o Data Cruiser
          encontra <b>todos os valores correspondentes</b> e os organiza automaticamente.
          Ideal para quem precisa de uma vis√£o completa, sem f√≥rmulas e sem complica√ß√£o.
        </span>
        </br>
        </br>
        <div class="px-2 m-1">
          <button class="btn btn-outline-light btn-sm" data-bs-toggle="modal" data-bs-target="#modalComoUsar">
            Como usar?
          </button>
        </div>
        </br>
        <div class="text-center my-5">
          <h5><strong>Como voc√™ pode nos ajudar? Espalhe a not√≠cia!</strong></h5>
          <p>Por favor, compartilhe a ferramenta para inspirar pessoas mais produtivas!</p>
          <div class="px-2 m-1">
            <button class="btn btn-outline-light btn-sm" data-bs-toggle="modal" data-bs-target="#modalCompartilhar">
              Compartilhar üîó
            </button>
          </div>
        </div>
      </p>
    </div>

    


    <form id="formulario" enctype="multipart/form-data" class="text-start mx-auto pt-5" style="max-width: 500px;">
      <label class="form-label">
        <b>Escolha os seus arquivos</b>
      </label>
      <div class="px-4 py-4 rounded-3 bg-dark">
        <div class="mb-3">
          <label class="form-label"><b>Planilha 1</b></label>
          <input type="file" name="file1" class="form-control" required>
          <div style="font-size: small;">
            <b>Importante:</b> a aplica√ß√£o clona a planilha 1 no resultado final, adicionando a compara√ß√£o nas colunas vazias seguintes.
            Portanto quanto <b>maior</b> a planilha 1, <b>maior</b> ser√° o tempo de processamento.
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label"><b>Planilha 2</b></label>
          <input type="file" name="file2" class="form-control" required>
        </div>
      </div>
      <div class="mb-3 pt-3">
        <label class="form-label">Coluna de busca na Planilha 1 (ex: A)</label>
        <input type="text" name="col1" class="form-control" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Coluna para comparar na Planilha 2 (ex: A)</label>
        <input type="text" name="col2" class="form-control" required>
      </div>
      <div class="mb-4">
        <label class="form-label">Coluna com valor desejado da Planilha 2 (ex: C)</label>
        <input type="text" name="col_val" class="form-control" required>
      </div>
      <button type="submit" class="btn btn-success w-100">Executar An√°lise</button>
    </form>
  </div>

<footer class="footer text-center text-white py-3 bg-dark">
  Um projeto <a href="https://pimsearch.com" target="_blank"><img src="/static/pimsearch-logo-white.png" alt="PIMBOT" style="width: 150px; padding-bottom: 10px;" /></a>
</footer>

<div id="loading-indicador" class="d-none position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-75 d-flex justify-content-center align-items-center" style="z-index: 9999;">
  <div class="text-center">
    <div class="spinner-border text-success" role="status" style="width: 3rem; height: 3rem;">
      <span class="visually-hidden">Carregando...</span>
    </div>
    <p class="mt-3 text-light">Processando Data Cruiser...</p>
  </div>
</div>

<!-- Modal - Como Usar -->
<div class="modal fade" id="modalComoUsar" tabindex="-1" aria-labelledby="comoUsarLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content bg-dark text-light">
      <div class="modal-header border-0">
        <h5 class="modal-title" id="comoUsarLabel">Como usar o <b>Data Cruiser</b></h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>
      <div class="modal-body">
        <ol class="text-start">
          <li>Escolha a <strong>Planilha 1</strong> que ser√° a base do resultado.</li>
          <li>Selecione a <strong>Planilha 2</strong> com os dados comparativos.</li>
          <li>Informe as colunas de compara√ß√£o e extra√ß√£o.</li>
          <li>Clique em <strong>Executar An√°lise</strong> e aguarde o download.</li>
        </ol>
      </div>
      <div class="modal-footer border-0">
        <button type="button" class="btn btn-success" data-bs-dismiss="modal">Entendi</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Compartilhamento -->
<div class="modal fade" id="modalCompartilhar" tabindex="-1" aria-labelledby="modalCompartilharLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content bg-dark text-light">
      <div class="modal-header border-0">
        <h5 class="modal-title" id="modalCompartilharLabel">Compartilhar Data Cruiser</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>
      <div class="modal-body text-center">
        <p>Ajude mais pessoas a descobrirem as ferramentas do PIMbot!</p>
        <input type="text" id="linkCompartilhamento" class="form-control mb-3 text-center" readonly value="https://datacruiser.pimsearch.com" onclick="this.select()">
        <div class="d-flex justify-content-center flex-wrap gap-2">
          <a class="btn btn-outline-primary" target="_blank" id="btnFacebook"><i class="bi bi-facebook"></i> Facebook</a>
          <a class="btn btn-outline-info" target="_blank" id="btnTwitter"><i class="bi bi-twitter-x"></i> x.com</a>
          <a class="btn btn-outline-secondary" target="_blank" id="btnLinkedin"><i class="bi bi-linkedin"></i> LinkedIn</a>
          <a class="btn btn-outline-success" target="_blank" id="btnWhatsapp"><i class="bi bi-whatsapp"></i> WhatsApp</a>
        </div>
      </div>
    </div>
  </div>
</div>


<script>
  const form = document.getElementById("formulario");
  const loading = document.getElementById("loading-indicador");

  form.addEventListener("submit", async (e) => {
    e.preventDefault(); // Impede envio padr√£o
    loading.classList.remove("d-none");

    const formData = new FormData(form);

    try {
      const response = await fetch("/", {
        method: "POST",
        body: formData,
      });

      if (!response.ok) throw new Error("Erro ao processar o arquivo.");

      const blob = await response.blob();
      const filename = response.headers.get("Content-Disposition")
        ?.split("filename=")[1]
        ?.replace(/"/g, "") || "resultado.xlsx";

      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = filename;
      document.body.appendChild(link);
      link.click();
      link.remove();
    } catch (error) {
      alert("Erro: " + error.message);
    } finally {
      loading.classList.add("d-none");
    }
  });
</script>

<script>
  const url = encodeURIComponent("https://datacruiser.pimsearch.com");
  const texto = encodeURIComponent("Conhe√ßa essa ferramenta incr√≠vel para comparar planilhas!");

  document.getElementById("btnFacebook").href = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
  document.getElementById("btnTwitter").href = `https://twitter.com/intent/tweet?text=${texto}&url=${url}`;
  document.getElementById("btnLinkedin").href = `https://www.linkedin.com/shareArticle?mini=true&url=${url}&title=${texto}`;
  document.getElementById("btnWhatsapp").href = `https://wa.me/?text=${texto}%20${url}`;
</script>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
